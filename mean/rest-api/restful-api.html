<!DOCTYPE HTML>
<html>
<head><meta name="viewport" content="width=device-width"/>
<title>Codeject</title>
<!-- STYLES & JQUERY 
================================================== -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="../../css/style.css"/>
<link rel="stylesheet" type="text/css" href="../../css/icons.css"/>
<link rel="stylesheet" type="text/css" href="../../css/slider.css"/>
<link rel="stylesheet" type="text/css" href="../../css/skinblue.css"/><!-- change skin color -->
<link rel="stylesheet" type="text/css" href="../../css/responsive.css"/>
<link rel="stylesheet" href="../../css/prism.css" >
<script src="../../js/jquery-1.9.0.min.js"></script>
<script src="../../js/prism.js"></script>

</head>
<body>
<!-- TOP LOGO & MENU
================================================== -->
<div class="grid">
	<div class="row space-bot">
		<!--Logo-->
		<div class="c4">
			<a href="../../index.html">
			<img src="../../images/logo.png" class="logo" alt="">
			</a>
		</div>
		<!--Menu-->
		<div class="c8">
      <nav id="topNav">
      <ul id="responsivemenu">
        <li class="last"><a href="../../index.html">Home</a></li>
        <li><a href="#">Tutorials</a>
        <ul style="display: none;">
          <li><a href="../../laravel.html">Laravel</a></li>
          <li><a href="../../mean-stack.html">MEAN Stack</a></li>         
          <li><a href="../../ionic.html">Ionic Framework</a></li>
        </ul>
        </li>    
      </ul>
      </nav>
  </div>
	</div>
</div>
<div class="undermenuarea">
</div>
<!-- START content area
================================================== -->
<!-- HEADER
================================================== -->
<div class="undermenuarea">
  <div class="boxedshadow">
  </div>
  <div class="grid">
    <div class="row">
      <div class="c8">
        <h1 class="titlehead">MEAN Stack</h1>
      </div>
    </div>
  </div>
</div>
<!-- CONTENT
================================================== -->
<div class="grid">
    <div class="shadowundertop">
    </div>
    <div class="row">   
      
      <!-- MAIN CONTENT -->
      <div class="c9">
        <h1 class="maintitle space-top">
        <span>Create REST-API</span>
        </h1>
        <div style="font-size: 18px;">
          <p>
            <b style="font-size: 20px; color: #0E8FAB">Installations</b><br>
            <b>API</b>s are very important concept in programming since it allows us to work across different platforms. Download and install <a href="https://nodejs.org/en/download/">nodejs</a> <br> You can check if you already have it installed using the command <b>node -v</b> <br><br>
            Create a folder for the project (named rest-api). Run in the folder directory <br>
            <script type="text/plain" class="language-markup">
              npm init
            </script><br>
            This will set up the configurations for node. The most important is to set the entry point as <b>index.js</b>. Create the file <b>index.js</b><br><br>
            Install <b>Express</b> by running
            <script type="text/plain" class="language-markup">
              npm install express --save
            </script><br>
             Install <b>body-parser</b> which will translate the request from the client by running
            <script type="text/plain" class="language-markup">
              npm install body-parser
            </script><br>
            After installing. Edit <b>index.js</b>
            <script type="text/plain" class="language-javascript; line-numbers">
               const express = require('express')
const app = express()

app.get('/', (req, res) => {
    res.send('Hello MEAN App');    
})

app.listen(8080, () => {
    console.log('Listening on port 8080');
})
            </script><br>
            To ensure that changes are automatically reflected, we'll use a tool called <b>nodemon</b> <br><br>
            <script type="text/plain" class="language-markup">
              npm install -g nodemon
            </script><br>
            To start the app, run <br>
            <script type="text/plain" class="language-markup">
              nodemon index.js
            </script><br>
            Head over to the browser and enter the url <b>localhost:8080/</b><br><br>
            <img src="../../images/mean-two/welcome.png"></li><br><br>
          </p>
          <p>
            <span style="font-size: 26px; color: #0E8FAB">MongoDB </span><br>
             The database that works seamlessly with the MEAN Stack is the MongoDB. Download Community Version of Mongodb from <a href="https://www.mongodb.com/download-center">here</a><br><br>
             We can also use a UI tool called Robomongo to work with the database. Download <a href="https://robomongo.org/download">here</a><br><br>
             To run the database. Using the terminal, navigate to the folder where it is installed. for windows, the path is something like <b>C:/Program Files/MongoDB/Server/3.4/bin</b>. Run <br><br>
             <script type="text/plain" class="language-markup">
              mongod
            </script><br>
            Add Mongoose.js Module as ORM for MongoDB. Install mongoose by running in the terminal <br>
            <script type="text/plain" class="language-markup">
              npm install mongoose --save
            </script><br>
            Ensure that the database server is running. Modify <b>index.js</b> to connect to it.<br> 
            <script type="text/plain" class="language-javascript; line-numbers">
              const express = require( 'express' );
const app = express();
const mongoose = require( 'mongoose' );

mongoose.Promise = global.Promise;

app.get( '/', ( req, res ) => {
    res.send( 'REST API App' );
});

mongoose.connect( 'mongodb://localhost/product' )
    .then(() => console.log( 'connection successful' ) )
    .catch(( err ) => console.error( err ) );

app.listen( 8080, () => {
    console.log( 'Listening on port 8080' );
})
            </script><br>
            You should see the success message in the console. Obviously, the database name will be product as seen above.
        </p>
        <p>
            <span style="font-size: 26px; color: #0E8FAB">Product Model</span><br>
            It's good programming principle that we separate our model into a different file. Create a new folder called models. In the folder, create a new file, name it <b>product.js</b> in the root directory. Add the contents below to the file <br>
            <script type="text/plain" class="language-javascript; line-numbers">
              var mongoose = require('mongoose');

var ProductSchema = new mongoose.Schema({
  name: String,
  desc: String,
  price: Number,
  updated_at: { type: Date, default: Date.now },
});

module.exports = mongoose.model('Product', ProductSchema);
            </script> <br>
            As seen above, we defined the attributes of the Product model. For the updated_at attribute, we are using a javascript function to assign it a timestamp. Finally, we exported the model. <br><br>
            <p>
            <span style="font-size: 26px; color: #0E8FAB">Routes for the REST API endpoint</span><br>
            What we need to do next is to create the routes for our API. We'll create a route to create, read, update and delete a product. <br> Create a folder <b>routes</b>. Create a file <b>product.js</b> in the routes folder. Let us start by adding a route that will add a new product to the database. <br><br>
            <b>routes/product.js</b><br>
            <script type="text/plain" class="language-javascript; line-numbers">
              const Product = require( '../models/product' );

module.exports = ( router ) => {
    // Create Product
    router.post( '/add', ( req, res ) => {
        if ( !req.body.name ) {
            res.send( { success: false, message: 'Provide the product name' });
        } else {
            if ( !req.body.desc ) {
                res.send( { success: false, message: 'Provide the product description' });
            } else {
                if ( !req.body.price ) {
                    res.send( { success: false, message: 'Provide product price' });
                } else {
                    let product = new Product( {
                        name: req.body.name,
                        desc: req.body.desc,
                        price: req.body.price
                    });

                    product.save(( err ) => {
                        if ( err ) {
                            res.send( { success: false, message: 'Could NOT product details. Error: ', err });
                        } else {
                            res.send( { success: true, message: 'Saved Successfully' });
                        }
                    });
                }
            }
        }
    });

    return router;
}

            </script><br>
            What we have above is quite basic. Remember, we are using Mongoose. This gives a clean way of interacting with the database. We create an instance of the model class. Next, we use if statments to ensure that users send the needed parameters. Notice that we are also sending back a json object. If all parameters are provided, we save the product. <br><br>
            To use this route, modify the <b>index.js</b> to reflect the changes below <br>
            <script type="text/plain" class="language-javascript; line-numbers">
              const express = require( 'express' );
const app = express();
const mongoose = require( 'mongoose' );
const router = express.Router();
const product = require('./routes/product')(router);
var bodyParser = require('body-parser');

mongoose.Promise = global.Promise;

app.get( '/', ( req, res ) => {
    res.send( 'REST API App' );
});

mongoose.connect( 'mongodb://localhost/product' )
    .then(() => console.log( 'connection successful' ) )
    .catch(( err ) => console.error( err ) );

// parse application/x-www-form-urlencoded
app.use(bodyParser.urlencoded({ extended: false }));

// parse application/json
app.use(bodyParser.json());

app.use('/product', product); 

app.listen( 8080, () => {
    console.log( 'Listening on port 8080' );
})
            </script><br>
            All request to the product route will need to be prefixed with <b>product</b>. We can now test our API by using a Chrome extension called Postman. <br><br>
            Install Postman if you don't have it. Launch Postman. Ensure that the mongodb instance is running. Choose request type as Post. Enter the url: <b>http://localhost:8080/product/all</b> <br>
            Click on the <b>body</b> tab and select <b>x-www-form-urlencoded</b>. <br>Enter a key value pair for the name, desc and price. Hit send, you should get a success message. <br><br>
            <img src="../../images/mean-two/postman.png"> <br><br>
            How cool is that! We'll complete the app in the next part.
            </p>
        </p>
        <div >
            <a style="text-align: right" href="rest-api_crud.html">Part 2 >> </a>
        </div>
        </div>
      </div>
      <!-- end main content -->
      
      <!-- SIDEBAR -->  
      <div class="c3">
        <div class="rightsidebar">
  <h2 class="title stresstitle">Subsections</h2><br>
  <a href="restful-api.html">Part 1</a><br>
  <a href="rest-api_crud.html">Part 2</a><br>
  </div> 
      </div><!-- end sidebar -->      
    </div>
</div><!-- end grid -->

<!-- FOOTER
================================================== -->
<div id="wrapfooter">
  <div class="grid">
    <div class="row" id="footer">
      <!-- to top button  -->
      <p class="back-top floatright">
        <a href="#top"><span></span></a>
      </p>
      <!-- 1st column -->
      <div class="c3">
        <img src="images/logo.png" style="padding-top: 70px;" alt="">
      </div>
      <!-- 2nd column -->
      <div class="c3">
        <h2 class="title">Author</h2>
        <hr class="footerstress">
        Have you read about these frameworks and find it difficult to put all the functions together and build a project? If yes, our tutorials will help you achieve that. <br>
        -- Mr. Kingslife
      </div>
      <!-- 3rd column -->
      <div class="c3">
        <h2 class="title"><i class="icon-envelope-alt"></i> Contact</h2>
        <hr class="footerstress">
        <dl>
          <dd><span>Telephone:</span>+234 803 425 5960</dd>
          <dd>E-mail: <a href="more.html">contact@codeject.site</a></dd>
        </dl>
        <ul class="social-links" style="margin-top:15px;">
          <li class="facebook-link smallrightmargin">
          <a href="https://fb.me/codeject" class="facebook has-tip" target="_blank" title="Join us on Facebook">Facebook</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
<!-- copyright area -->
<div class="copyright">
  <div class="grid">
    <div class="row">
      <div class="c6">
         CodeJect &copy; 2018. All Rights Reserved.
      </div>
    </div>
  </div>
</div>
<!-- END CONTENT AREA -->
<!-- JAVASCRIPTS
================================================== -->
<!-- all -->
<script src="../../js/modernizr-latest.js"></script>

<!-- menu & scroll to top -->
<script src="../../js/common.js"></script>

<!-- slider -->
<script src="../../js/jquery.cslider.js"></script>

<!-- cycle -->
<script src="../../js/jquery.cycle.js"></script>

<!-- carousel items -->
<script src="../../js/jquery.carouFredSel-6.0.3-packed.js"></script>

<!-- twitter -->
<script src="../../js/jquery.tweet.js"></script>

<!-- Call Showcase - change 4 from min:4 and max:4 to the number of items you want visible -->
<script type="text/javascript">
$(window).load(function(){			
			$('#recent-projects').carouFredSel({
				responsive: true,
				width: '100%',
				auto: true,
				circular	: true,
				infinite	: false,
				prev : {
					button		: "#car_prev",
					key			: "left",
						},
				next : {
					button		: "#car_next",
					key			: "right",
							},
				swipe: {
					onMouse: true,
					onTouch: true
					},
				scroll : 2000,
				items: {
					visible: {
						min: 4,
						max: 4
					}
				}
			});
		});	
</script>

<!-- Call opacity on hover images from carousel-->
<script type="text/javascript">
$(document).ready(function(){
    $("img.imgOpa").hover(function() {
      $(this).stop().animate({opacity: "0.6"}, 'slow');
    },
    function() {
      $(this).stop().animate({opacity: "1.0"}, 'slow');
    });
  });
</script>
</body>
</html>